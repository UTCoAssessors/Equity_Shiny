Valuation::ratio_stats(which_min$preds, which_min$tasp)
which_min <- Preds %>%
dplyr::mutate(serno = as.character(serno),
serno = ifelse(nchar(serno) == 8, paste0('0', serno), serno)) %>%
dplyr::left_join(df) %>%
dplyr::filter(!is.na(tasp), sold_year == 2022 & valid == T & year_built < 2021) %>%
dplyr::mutate(dif_this = abs(.95adjusted_prediction - tasp),
mean(which_min$which_min, na.rm= T)
which_min <- Preds %>%
dplyr::mutate(serno = as.character(serno),
serno = ifelse(nchar(serno) == 8, paste0('0', serno), serno)) %>%
dplyr::left_join(df) %>%
dplyr::filter(!is.na(tasp), sold_year == 2022 & valid == T & year_built < 2021) %>%
dplyr::mutate(dif_this = abs(.95*adjusted_prediction - tasp),
dif_that = abs(tot_val_2022 - tasp),
which_min = ifelse(dif_this < dif_that,1,0)) %>%
dplyr::select(serno, adjusted_prediction, tot_val_2022, which_min, dif_this, dif_that, tasp) %>%
dplyr::mutate(preds = ifelse(which_min == 1, adjusted_prediction, adjusted_prediction)) %>%
data.frame
mean(which_min$which_min, na.rm= T)
# IMPORT DATA ####
getwd()
which_min <- Preds %>%
dplyr::mutate(serno = as.character(serno),
serno = ifelse(nchar(serno) == 8, paste0('0', serno), serno)) %>%
dplyr::left_join(df) %>%
dplyr::filter(!is.na(tasp), sold_year == 2021 & valid == T & year_built < 2021) %>%
dplyr::mutate(dif_this = abs(.95*adjusted_prediction - tasp),
dif_that = abs(tot_val_2022 - tasp),
which_min = ifelse(dif_this < dif_that,1,0)) %>%
dplyr::select(serno, adjusted_prediction, tot_val_2022, which_min, dif_this, dif_that, tasp) %>%
dplyr::mutate(preds = ifelse(which_min == 1, adjusted_prediction, adjusted_prediction)) %>%
data.frame
libraru(tidyverse)
library(tidyverse)
which_min <- Preds %>%
dplyr::mutate(serno = as.character(serno),
serno = ifelse(nchar(serno) == 8, paste0('0', serno), serno)) %>%
dplyr::left_join(df) %>%
dplyr::filter(!is.na(tasp), sold_year == 2021 & valid == T & year_built < 2021) %>%
dplyr::mutate(dif_this = abs(.95*adjusted_prediction - tasp),
dif_that = abs(tot_val_2022 - tasp),
which_min = ifelse(dif_this < dif_that,1,0)) %>%
dplyr::select(serno, adjusted_prediction, tot_val_2022, which_min, dif_this, dif_that, tasp) %>%
dplyr::mutate(preds = ifelse(which_min == 1, adjusted_prediction, adjusted_prediction)) %>%
data.frame
mean(which_min$which_min, na.rm= T)
which_min <- Preds %>%
dplyr::mutate(serno = as.character(serno),
serno = ifelse(nchar(serno) == 8, paste0('0', serno), serno)) %>%
dplyr::left_join(df) %>%
dplyr::filter(!is.na(tasp), sold_year == 2021 & valid == T & year_built < 2021) %>%
dplyr::mutate(dif_this = abs(adjusted_prediction_cap - tasp),
dif_that = abs(tot_val_2022 - tasp),
which_min = ifelse(dif_this < dif_that,1,0)) %>%
dplyr::select(serno, adjusted_prediction, tot_val_2022, which_min, dif_this, dif_that, tasp) %>%
dplyr::mutate(preds = ifelse(which_min == 1, adjusted_prediction, adjusted_prediction)) %>%
data.frame
mean(which_min$which_min, na.rm= T)
Valuation::ratio_stats(which_min$preds, which_min$tasp)
which_min <- Preds %>%
dplyr::mutate(serno = as.character(serno),
serno = ifelse(nchar(serno) == 8, paste0('0', serno), serno)) %>%
dplyr::left_join(df) %>%
dplyr::filter(!is.na(tasp), sold_year == 2021 & valid == T & year_built < 2021) %>%
dplyr::mutate(dif_this = abs(adjusted_prediction_cap - tasp),
dif_that = abs(tot_val_2022 - tasp),
which_min = ifelse(dif_this < dif_that,1,0)) %>%
dplyr::select(serno, adjusted_prediction, tot_val_2022, which_min, dif_this, dif_that, tasp) %>%
dplyr::mutate(preds = ifelse(which_min == 1, adjusted_prediction_cap, tot_val_2022)) %>%
data.frame
mean(which_min$which_min, na.rm= T)
which_min <- Preds %>%
dplyr::mutate(serno = as.character(serno),
serno = ifelse(nchar(serno) == 8, paste0('0', serno), serno)) %>%
dplyr::left_join(df) %>%
dplyr::filter(!is.na(tasp), sold_year == 2021 & valid == T & year_built < 2021) %>%
dplyr::mutate(dif_this = abs(adjusted_prediction_cap - tasp),
dif_that = abs(tot_val_2022 - tasp),
which_min = ifelse(dif_this < dif_that,1,0)) %>%
dplyr::select(serno, adjusted_prediction, tot_val_2022, which_min, dif_this, dif_that, tasp) %>%
dplyr::mutate(preds = ifelse(which_min == 1, adjusted_prediction_cap, tot_val_2022)) %>%
data.frame
which_min <- Preds %>%
dplyr::mutate(serno = as.character(serno),
serno = ifelse(nchar(serno) == 8, paste0('0', serno), serno)) %>%
dplyr::left_join(df) %>%
dplyr::filter(!is.na(tasp), sold_year == 2021 & valid == T & year_built < 2021) %>%
dplyr::mutate(dif_this = abs(adjusted_prediction_cap - tasp),
dif_that = abs(tot_val_2022 - tasp),
which_min = ifelse(dif_this < dif_that,1,0)) %>%
dplyr::select(serno, adjusted_prediction_cap, tot_val_2022, which_min, dif_this, dif_that, tasp) %>%
dplyr::mutate(preds = ifelse(which_min == 1, adjusted_prediction_cap, tot_val_2022)) %>%
data.frame
mean(which_min$which_min, na.rm= T)
which.max(which_min$dif_this - which_min$dif_that)
which_min
Valuation::ratio_stats(which_min$preds, which_min$tasp)
which_min <- Preds %>%
dplyr::mutate(serno = as.character(serno),
serno = ifelse(nchar(serno) == 8, paste0('0', serno), serno)) %>%
dplyr::left_join(df) %>%
dplyr::filter(!is.na(tasp), sold_year == 2021 & valid == T & year_built < 2021) %>%
dplyr::mutate(dif_this = abs(adjusted_prediction_cap - tasp),
dif_that = abs(tot_val_2022 - tasp),
which_min = ifelse(dif_this < dif_that,1,0)) %>%
dplyr::select(serno, adjusted_prediction_cap, tot_val_2022, which_min, dif_this, dif_that, tasp) %>%
dplyr::mutate(preds = ifelse(which_min == 1, adjusted_prediction_cap, tot_val_2022)) %>%
data.frame
mean(which_min$which_min, na.rm= T)
which.max(which_min$dif_this - which_min$dif_that)
which_min
Valuation::ratio_stats(which_min$preds, which_min$tasp)
sum()
which_min
which_min$which_min
which_min$dif_that
mean(which_min$dif_that)
mean(which_min$dif_this)
which_min <- Preds %>%
dplyr::mutate(serno = as.character(serno),
serno = ifelse(nchar(serno) == 8, paste0('0', serno), serno)) %>%
dplyr::left_join(df) %>%
dplyr::filter(!is.na(tasp), sold_year == 2022 & valid == T & year_built < 2021) %>%
dplyr::mutate(dif_this = abs(adjusted_prediction_cap - tasp),
dif_that = abs(tot_val_2022 - tasp),
which_min = ifelse(dif_this < dif_that,1,0)) %>%
dplyr::select(serno, adjusted_prediction_cap, tot_val_2022, which_min, dif_this, dif_that, tasp) %>%
dplyr::mutate(preds = ifelse(which_min == 1, adjusted_prediction_cap, tot_val_2022)) %>%
data.frame
mean(which_min$which_min, na.rm= T)
which.max(which_min$dif_this - which_min$dif_that)
which_min
Valuation::ratio_stats(which_min$preds, which_min$tasp)
mean(which_min$dif_that)
mean(which_min$dif_this)
mean(which_min$dif_that, na.rm = T)
mean(which_min$dif_this, na.rm=T)
median(which_min$dif_that, na.rm = T)
median(which_min$dif_this, na.rm=T)
which_min <- Preds %>%
dplyr::mutate(serno = as.character(serno),
serno = ifelse(nchar(serno) == 8, paste0('0', serno), serno)) %>%
dplyr::left_join(df) %>%
dplyr::filter(!is.na(tasp), sold_year == 2021 & valid == T & year_built < 2021) %>%
dplyr::mutate(dif_this = abs(adjusted_prediction_cap - tasp),
dif_that = abs(tot_val_2022 - tasp),
which_min = ifelse(dif_this < dif_that,1,0)) %>%
dplyr::select(serno, adjusted_prediction_cap, tot_val_2022, which_min, dif_this, dif_that, tasp) %>%
dplyr::mutate(preds = ifelse(which_min == 1, adjusted_prediction_cap, tot_val_2022)) %>%
data.frame
mean(which_min$which_min, na.rm= T)
which.max(which_min$dif_this - which_min$dif_that)
which_min
Valuation::ratio_stats(which_min$preds, which_min$tasp)
median(which_min$dif_that, na.rm = T)
median(which_min$dif_this, na.rm=T)
which_min <- Preds %>%
dplyr::mutate(serno = as.character(serno),
serno = ifelse(nchar(serno) == 8, paste0('0', serno), serno)) %>%
dplyr::left_join(df) %>%
dplyr::filter(!is.na(tasp), sold_year == 2020 & valid == T & year_built < 2021) %>%
dplyr::mutate(dif_this = abs(adjusted_prediction_cap - tasp),
dif_that = abs(tot_val_2022 - tasp),
which_min = ifelse(dif_this < dif_that,1,0)) %>%
dplyr::select(serno, adjusted_prediction_cap, tot_val_2022, which_min, dif_this, dif_that, tasp) %>%
dplyr::mutate(preds = ifelse(which_min == 1, adjusted_prediction_cap, tot_val_2022)) %>%
data.frame
mean(which_min$which_min, na.rm= T)
which.max(which_min$dif_this - which_min$dif_that)
which_min
Valuation::ratio_stats(which_min$preds, which_min$tasp)
median(which_min$dif_that, na.rm = T)
median(which_min$dif_this, na.rm=T)
which_min <- Preds %>%
dplyr::mutate(serno = as.character(serno),
serno = ifelse(nchar(serno) == 8, paste0('0', serno), serno)) %>%
dplyr::left_join(df) %>%
dplyr::filter(!is.na(tasp), sold_year == 2022 & valid == T & year_built < 2021) %>%
dplyr::mutate(dif_this = abs(adjusted_prediction_cap - tasp),
dif_that = abs(tot_val_2022 - tasp),
which_min = ifelse(dif_this < dif_that,1,0)) %>%
dplyr::select(serno, adjusted_prediction_cap, tot_val_2022, which_min, dif_this, dif_that, tasp) %>%
dplyr::mutate(preds = ifelse(which_min == 1, adjusted_prediction_cap, tot_val_2022)) %>%
data.frame
mean(which_min$which_min, na.rm= T)
which.max(which_min$dif_this - which_min$dif_that)
which_min
Valuation::ratio_stats(which_min$preds, which_min$tasp)
median(which_min$dif_that, na.rm = T)
median(which_min$dif_this, na.rm=T)
mean(which_min$which_min, na.rm= T)
which_min <- Preds %>%
dplyr::mutate(serno = as.character(serno),
serno = ifelse(nchar(serno) == 8, paste0('0', serno), serno)) %>%
dplyr::left_join(df) %>%
dplyr::filter(!is.na(tasp), valid == T & year_built < 2021) %>%
dplyr::mutate(dif_this = abs(adjusted_prediction_cap - tasp),
dif_that = abs(tot_val_2022 - tasp),
which_min = ifelse(dif_this < dif_that,1,0)) %>%
dplyr::select(serno, adjusted_prediction_cap, tot_val_2022, which_min, dif_this, dif_that, tasp) %>%
dplyr::mutate(preds = ifelse(which_min == 1, adjusted_prediction_cap, tot_val_2022)) %>%
data.frame
mean(which_min$which_min, na.rm= T)
which_min <- Preds %>%
dplyr::mutate(serno = as.character(serno),
serno = ifelse(nchar(serno) == 8, paste0('0', serno), serno)) %>%
dplyr::left_join(df) %>%
dplyr::filter(!is.na(tasp), valid == T & year_built < 2021) %>%
dplyr::mutate(dif_this = abs(adjusted_prediction - tasp),
dif_that = abs(tot_val_2022 - tasp),
which_min = ifelse(dif_this < dif_that,1,0)) %>%
dplyr::select(serno, adjusted_prediction_cap, tot_val_2022, which_min, dif_this, dif_that, tasp) %>%
dplyr::mutate(preds = ifelse(which_min == 1, adjusted_prediction_cap, tot_val_2022)) %>%
data.frame
mean(which_min$which_min, na.rm= T)
which.max(which_min$dif_this - which_min$dif_that)
which_min
Valuation::ratio_stats(which_min$preds, which_min$tasp)
median(which_min$dif_that, na.rm = T)
median(which_min$dif_this, na.rm=T)
median(which_min$dif_that, na.rm = T)
median(which_min$dif_this, na.rm=T)
Valuation::ratio_stats(which_min$preds, which_min$tasp)
median(which_min$dif_that, na.rm = T)
median(which_min$dif_this, na.rm=T)
which_min <- Preds %>%
dplyr::mutate(serno = as.character(serno),
serno = ifelse(nchar(serno) == 8, paste0('0', serno), serno)) %>%
dplyr::left_join(df) %>%
dplyr::filter(!is.na(tasp), valid == T & year_built < 2021) %>%
dplyr::mutate(dif_this = abs(adjusted_prediction - tasp),
dif_that = abs(tot_val_2022 - tasp),
which_min = ifelse(dif_this < dif_that,1,0)) %>%
dplyr::select(serno, adjusted_prediction_cap, tot_val_2022, which_min, dif_this, dif_that, tasp) %>%
dplyr::mutate(preds = ifelse(which_min == 1, adjusted_prediction_cap, tot_val_2022)) %>%
data.frame
mean(which_min$which_min, na.rm= T)
which.max(which_min$dif_this - which_min$dif_that)
which_min
Valuation::ratio_stats(which_min$preds, which_min$tasp)
median(which_min$dif_that, na.rm = T)
median(which_min$dif_this, na.rm=T)
Preds <- read.csv('./Data/FinalPreds.csv') %>%
janitor::clean_names() %>%
dplyr::select(serno, tasp, scaled_pred_cap, scaled_pred, adjusted_prediction_cap, adjusted_prediction, tot_val_2022, re_res, re_agr, re_com, im_agr, pct_change)
library(tidyverse)
Preds <- read.csv('./Data/FinalPreds.csv') %>%
janitor::clean_names() %>%
dplyr::select(serno, tasp, scaled_pred_cap, scaled_pred, adjusted_prediction_cap, adjusted_prediction, tot_val_2022, re_res, re_agr, re_com, im_agr, pct_change)
which_min <- Preds %>%
dplyr::mutate(serno = as.character(serno),
serno = ifelse(nchar(serno) == 8, paste0('0', serno), serno)) %>%
dplyr::left_join(df) %>%
dplyr::filter(!is.na(tasp), valid == T & year_built < 2021) %>%
dplyr::mutate(dif_this = abs(adjusted_prediction - tasp),
dif_that = abs(tot_val_2022 - tasp),
which_min = ifelse(dif_this < dif_that,1,0)) %>%
dplyr::select(serno, adjusted_prediction_cap, tot_val_2022, which_min, dif_this, dif_that, tasp) %>%
dplyr::mutate(preds = ifelse(which_min == 1, adjusted_prediction_cap, tot_val_2022)) %>%
data.frame
mean(which_min$which_min, na.rm= T)
which.max(which_min$dif_this - which_min$dif_that)
which_min
Valuation::ratio_stats(which_min$preds, which_min$tasp)
median(which_min$dif_that, na.rm = T)
median(which_min$dif_this, na.rm=T)
which_min <- Preds %>%
dplyr::mutate(serno = as.character(serno),
serno = ifelse(nchar(serno) == 8, paste0('0', serno), serno)) %>%
dplyr::left_join(df) %>%
dplyr::filter(!is.na(tasp), sold_year==2022, valid == T & year_built < 2021) %>%
dplyr::mutate(dif_this = abs(adjusted_prediction_cap - tasp),
dif_that = abs(tot_val_2022 - tasp),
which_min = ifelse(dif_this < dif_that,1,0)) %>%
dplyr::select(serno, adjusted_prediction_cap, tot_val_2022, which_min, dif_this, dif_that, tasp) %>%
dplyr::mutate(preds = ifelse(which_min == 1, adjusted_prediction_cap, tot_val_2022)) %>%
data.frame
mean(which_min$which_min, na.rm= T)
which.max(which_min$dif_this - which_min$dif_that)
which_min
Valuation::ratio_stats(which_min$preds, which_min$tasp)
median(which_min$dif_that, na.rm = T)
median(which_min$dif_this, na.rm=T)
mean(which_min$dif_that, na.rm = T)
mean(which_min$dif_this, na.rm=T)
which_min <- Preds %>%
dplyr::mutate(serno = as.character(serno),
serno = ifelse(nchar(serno) == 8, paste0('0', serno), serno)) %>%
dplyr::left_join(df) %>%
dplyr::filter(!is.na(tasp), sold_year==2021, valid == T & year_built < 2021) %>%
dplyr::mutate(dif_this = abs(adjusted_prediction_cap - tasp),
dif_that = abs(tot_val_2022 - tasp),
which_min = ifelse(dif_this < dif_that,1,0)) %>%
dplyr::select(serno, adjusted_prediction_cap, tot_val_2022, which_min, dif_this, dif_that, tasp) %>%
dplyr::mutate(preds = ifelse(which_min == 1, adjusted_prediction_cap, tot_val_2022)) %>%
data.frame
mean(which_min$which_min, na.rm= T)
which.max(which_min$dif_this - which_min$dif_that)
which_min
Valuation::ratio_stats(which_min$preds, which_min$tasp)
mean(which_min$dif_that, na.rm = T)
mean(which_min$dif_this, na.rm=T)
which_min <- Preds %>%
dplyr::mutate(serno = as.character(serno),
serno = ifelse(nchar(serno) == 8, paste0('0', serno), serno)) %>%
dplyr::left_join(df) %>%
dplyr::filter(!is.na(tasp), sold_year==2020, valid == T & year_built < 2021) %>%
dplyr::mutate(dif_this = abs(adjusted_prediction_cap - tasp),
dif_that = abs(tot_val_2022 - tasp),
which_min = ifelse(dif_this < dif_that,1,0)) %>%
dplyr::select(serno, adjusted_prediction_cap, tot_val_2022, which_min, dif_this, dif_that, tasp) %>%
dplyr::mutate(preds = ifelse(which_min == 1, adjusted_prediction_cap, tot_val_2022)) %>%
data.frame
mean(which_min$which_min, na.rm= T)
which.max(which_min$dif_this - which_min$dif_that)
which_min
Valuation::ratio_stats(which_min$preds, which_min$tasp)
mean(which_min$dif_that, na.rm = T)
mean(which_min$dif_this, na.rm=T)
which_min <- Preds %>%
dplyr::mutate(serno = as.character(serno),
serno = ifelse(nchar(serno) == 8, paste0('0', serno), serno)) %>%
dplyr::left_join(df) %>%
dplyr::filter(!is.na(tasp), sold_year==2020, valid == T & year_built < 2021) %>%
dplyr::mutate(dif_this = abs(adjusted_prediction_cap - tasp),
dif_that = abs(tot_val_2022 - tasp),
which_min = ifelse(dif_this < dif_that,1,0)) %>%
dplyr::select(serno, adjusted_prediction_cap, tot_val_2022, which_min, dif_this, dif_that, tasp) %>%
dplyr::mutate(preds = ifelse(which_min == 1, tot_val_2022, tot_val_2022)) %>%
data.frame
mean(which_min$which_min, na.rm= T)
which.max(which_min$dif_this - which_min$dif_that)
which_min
Valuation::ratio_stats(which_min$preds, which_min$tasp)
which_min <- Preds %>%
dplyr::mutate(serno = as.character(serno),
serno = ifelse(nchar(serno) == 8, paste0('0', serno), serno)) %>%
dplyr::left_join(df) %>%
dplyr::filter(!is.na(tasp), sold_year==2021, valid == T & year_built < 2021) %>%
dplyr::mutate(dif_this = abs(adjusted_prediction_cap - tasp),
dif_that = abs(tot_val_2022 - tasp),
which_min = ifelse(dif_this < dif_that,1,0)) %>%
dplyr::select(serno, adjusted_prediction_cap, tot_val_2022, which_min, dif_this, dif_that, tasp) %>%
dplyr::mutate(preds = ifelse(which_min == 1, tot_val_2022, tot_val_2022)) %>%
data.frame
mean(which_min$which_min, na.rm= T)
which.max(which_min$dif_this - which_min$dif_that)
which_min
Valuation::ratio_stats(which_min$preds, which_min$tasp)
mean(which_min$dif_that, na.rm = T)
mean(which_min$dif_this, na.rm=T)
which_min <- Preds %>%
dplyr::mutate(serno = as.character(serno),
serno = ifelse(nchar(serno) == 8, paste0('0', serno), serno)) %>%
dplyr::left_join(df) %>%
dplyr::filter(!is.na(tasp), sold_year==2021, valid == T & year_built < 2021) %>%
dplyr::mutate(dif_this = abs(adjusted_prediction_cap - tasp),
dif_that = abs(tot_val_2022 - tasp),
which_min = ifelse(dif_this < dif_that,1,0)) %>%
dplyr::select(serno, adjusted_prediction_cap, tot_val_2022, which_min, dif_this, dif_that, tasp) %>%
dplyr::mutate(preds = ifelse(which_min == 1, adjusted_prediction_cap, adjusted_prediction_cap)) %>%
data.frame
mean(which_min$which_min, na.rm= T)
which.max(which_min$dif_this - which_min$dif_that)
which_min
Valuation::ratio_stats(which_min$preds, which_min$tasp)
mean(which_min$dif_that, na.rm = T)
mean(which_min$dif_this, na.rm=T)
which_min <- Preds %>%
dplyr::mutate(serno = as.character(serno),
serno = ifelse(nchar(serno) == 8, paste0('0', serno), serno)) %>%
dplyr::left_join(df) %>%
dplyr::filter(!is.na(tasp), sold_year==2021, valid == T & year_built < 2021) %>%
dplyr::mutate(dif_this = abs(adjusted_prediction_cap - tasp),
dif_that = abs(tot_val_2022 - tasp),
which_min = ifelse(dif_this < dif_that,1,0)) %>%
dplyr::select(serno, adjusted_prediction_cap, tot_val_2022, which_min, dif_this, dif_that, tasp) %>%
dplyr::mutate(preds = ifelse(which_min == 1, tot_val_2022, tot_val_2022)) %>%
data.frame
mean(which_min$which_min, na.rm= T)
which.max(which_min$dif_this - which_min$dif_that)
which_min <- Preds %>%
dplyr::mutate(serno = as.character(serno),
serno = ifelse(nchar(serno) == 8, paste0('0', serno), serno)) %>%
dplyr::left_join(df) %>%
dplyr::filter(!is.na(tasp), sold_year==2022, valid == T & year_built < 2021) %>%
dplyr::mutate(dif_this = abs(adjusted_prediction_cap - tasp),
dif_that = abs(tot_val_2022 - tasp),
which_min = ifelse(dif_this < dif_that,1,0)) %>%
dplyr::select(serno, adjusted_prediction_cap, tot_val_2022, which_min, dif_this, dif_that, tasp) %>%
dplyr::mutate(preds = ifelse(which_min == 1, tot_val_2022, tot_val_2022)) %>%
data.frame
mean(which_min$which_min, na.rm= T)
which.max(which_min$dif_this - which_min$dif_that)
which_min
Valuation::ratio_stats(which_min$preds, which_min$tasp)
mean(which_min$dif_that, na.rm = T)
mean(which_min$dif_this, na.rm=T)
which_min <- Preds %>%
dplyr::mutate(serno = as.character(serno),
serno = ifelse(nchar(serno) == 8, paste0('0', serno), serno)) %>%
dplyr::left_join(df) %>%
dplyr::filter(!is.na(tasp), sold_year==2022, valid == T & year_built < 2021) %>%
dplyr::mutate(dif_this = abs(1.05adjusted_prediction_cap - tasp),
mean(which_min$which_min, na.rm= T)
which.max(which_min$dif_this - which_min$dif_that)
which_min
Valuation::ratio_stats(which_min$preds, which_min$tasp)
mean(which_min$dif_that, na.rm = T)
mean(which_min$dif_this, na.rm=T)
which_min <- Preds %>%
dplyr::mutate(serno = as.character(serno),
serno = ifelse(nchar(serno) == 8, paste0('0', serno), serno)) %>%
dplyr::left_join(df) %>%
dplyr::filter(!is.na(tasp), sold_year==2022, valid == T & year_built < 2021) %>%
dplyr::mutate(dif_this = abs(1.05*adjusted_prediction_cap - tasp),
dif_that = abs(1.05*tot_val_2022 - tasp),
which_min = ifelse(dif_this < dif_that,1,0)) %>%
dplyr::select(serno, adjusted_prediction_cap, tot_val_2022, which_min, dif_this, dif_that, tasp) %>%
dplyr::mutate(preds = ifelse(which_min == 1, tot_val_2022, tot_val_2022)) %>%
data.frame
mean(which_min$which_min, na.rm= T)
which.max(which_min$dif_this - which_min$dif_that)
which_min
Valuation::ratio_stats(which_min$preds, which_min$tasp)
mean(which_min$dif_that, na.rm = T)
mean(which_min$dif_this, na.rm=T)
which_min <- Preds %>%
dplyr::mutate(serno = as.character(serno),
serno = ifelse(nchar(serno) == 8, paste0('0', serno), serno)) %>%
dplyr::left_join(df) %>%
dplyr::filter(!is.na(tasp), sold_year==2023, valid == T & year_built < 2021) %>%
dplyr::mutate(dif_this = abs(adjusted_prediction_cap - tasp),
dif_that = abs(tot_val_2022 - tasp),
which_min = ifelse(dif_this < dif_that,1,0)) %>%
dplyr::select(serno, adjusted_prediction_cap, tot_val_2022, which_min, dif_this, dif_that, tasp) %>%
dplyr::mutate(preds = ifelse(which_min == 1, tot_val_2022, tot_val_2022)) %>%
data.frame
mean(which_min$which_min, na.rm= T)
which.max(which_min$dif_this - which_min$dif_that)
which_min
Valuation::ratio_stats(which_min$preds, which_min$tasp)
which_min <- Preds %>%
dplyr::mutate(serno = as.character(serno),
serno = ifelse(nchar(serno) == 8, paste0('0', serno), serno)) %>%
dplyr::left_join(df) %>%
dplyr::filter(!is.na(tasp), sold_year==2020, valid == T & year_built < 2021) %>%
dplyr::mutate(dif_this = abs(adjusted_prediction_cap - tasp),
dif_that = abs(tot_val_2022 - tasp),
which_min = ifelse(dif_this < dif_that,1,0)) %>%
dplyr::select(serno, adjusted_prediction_cap, tot_val_2022, which_min, dif_this, dif_that, tasp) %>%
dplyr::mutate(preds = ifelse(which_min == 1, tot_val_2022, tot_val_2022)) %>%
data.frame
mean(which_min$which_min, na.rm= T)
which.max(which_min$dif_this - which_min$dif_that)
which_min
Valuation::ratio_stats(which_min$preds, which_min$tasp)
mean(which_min$dif_that, na.rm = T)
mean(which_min$dif_this, na.rm=T)
which_min <- Preds %>%
dplyr::mutate(serno = as.character(serno),
serno = ifelse(nchar(serno) == 8, paste0('0', serno), serno)) %>%
dplyr::left_join(df) %>%
dplyr::filter(!is.na(tasp), sold_year==2021, valid == T & year_built < 2021) %>%
dplyr::mutate(dif_this = abs(adjusted_prediction_cap - tasp),
dif_that = abs(tot_val_2022 - tasp),
which_min = ifelse(dif_this < dif_that,1,0)) %>%
dplyr::select(serno, adjusted_prediction_cap, tot_val_2022, which_min, dif_this, dif_that, tasp) %>%
dplyr::mutate(preds = ifelse(which_min == 1, tot_val_2022, tot_val_2022)) %>%
data.frame
mean(which_min$which_min, na.rm= T)
which.max(which_min$dif_this - which_min$dif_that)
which_min
Valuation::ratio_stats(which_min$preds, which_min$tasp)
which_min <- Preds %>%
dplyr::mutate(serno = as.character(serno),
serno = ifelse(nchar(serno) == 8, paste0('0', serno), serno)) %>%
dplyr::left_join(df) %>%
dplyr::filter(!is.na(tasp), sold_year==2022, valid == T & year_built < 2021) %>%
dplyr::mutate(dif_this = abs(adjusted_prediction_cap - tasp),
dif_that = abs(tot_val_2022 - tasp),
which_min = ifelse(dif_this < dif_that,1,0)) %>%
dplyr::select(serno, adjusted_prediction_cap, tot_val_2022, which_min, dif_this, dif_that, tasp) %>%
dplyr::mutate(preds = ifelse(which_min == 1, tot_val_2022, tot_val_2022)) %>%
data.frame
mean(which_min$which_min, na.rm= T)
which.max(which_min$dif_this - which_min$dif_that)
which_min
Valuation::ratio_stats(which_min$preds, which_min$tasp)
mean(which_min$dif_that, na.rm = T)
mean(which_min$dif_this, na.rm=T)
which_min <- Preds %>%
dplyr::mutate(serno = as.character(serno),
serno = ifelse(nchar(serno) == 8, paste0('0', serno), serno)) %>%
dplyr::left_join(df) %>%
dplyr::filter(!is.na(tasp), sold_year==2023, valid == T & year_built < 2021) %>%
dplyr::mutate(dif_this = abs(adjusted_prediction_cap - tasp),
dif_that = abs(tot_val_2022 - tasp),
which_min = ifelse(dif_this < dif_that,1,0)) %>%
dplyr::select(serno, adjusted_prediction_cap, tot_val_2022, which_min, dif_this, dif_that, tasp) %>%
dplyr::mutate(preds = ifelse(which_min == 1, tot_val_2022, tot_val_2022)) %>%
data.frame
mean(which_min$which_min, na.rm= T)
which.max(which_min$dif_this - which_min$dif_that)
which_min
Valuation::ratio_stats(which_min$preds, which_min$tasp)
mean(which_min$dif_that, na.rm = T)
mean(which_min$dif_this, na.rm=T)
shiny::runApp()
shiny::runApp()
shiny::runApp()
